using System.Text;

namespace Modeler.ComponentsModel.Views.AsciiDoc;

public class AsciiDocComponentsListTableViewGenerator
{
    private readonly Model _model;

    private readonly IAsciiDocComponentsListTableViewOutput _output;

    public AsciiDocComponentsListTableViewGenerator(
        Model model,
        IAsciiDocComponentsListTableViewOutput output)
    {
        _model = model;
        _output = output;
    }

    public void Generate()
    {
        var sb = new StringBuilder();

        sb.AppendLine("// Generated by Modeler - do not change.");
        
        sb.AppendLine("|===");
        sb.AppendLine("|Name|Type");
        sb.AppendLine();

        var allComponents = _model.GetAllComponents();
        foreach (var component in allComponents)
        {
            sb.AppendLine($"|{component.Name}");
            sb.AppendLine($"|{component.Type.Name}");
            sb.AppendLine();
        }
        
        sb.AppendLine();
        sb.AppendLine("|===");
        
        _output.Execute(sb.ToString());
    }
}